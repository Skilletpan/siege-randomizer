name: Deploy App
on:
  push:
    branches: [ master ]
  
  pull_request:
    branches: [ develop ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Build App
        uses: ./.github/workflows/build.yaml
      
      - name: Add build files
        run: git add dist -f
      
      - name: Create build commit
        run: git commit -m "${{ github.event.head_commit.message }}"

      - name: Create build directory subtree
        run: git subtree split --prefix dist -b gh-pages
      
      # - name: Push build directory to pages branch
      #   run: git push -f origin gh-pages:pages